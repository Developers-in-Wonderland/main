# 회의 기록

* **일시:** 10주차
* **장소:** 오프라인, 온라인
* **작성자:** 김종원

## 참석자

* 김종원
* 김동현
* 손홍준
* 최민주

---

## 진행 내용

* **최종 발표용 패널 제작 PPT 작성 완료**
* **로봇팔 제어 코드 전면 리디자인 완료**
* 제어 주체를 “각도 기반 → PWM 기반”으로 변경하여 실제 서보 반응성 향상
* 실험 중 발생한 **모터 진동(디지털 서보 특성)** 해결 중심으로 코드 수정 진행

---

## 논의 내용

### 1️⃣ 제어 시스템 주요 변경 사항

| 구분              | 변경 전                            | 변경 후                                                           | 개선 효과                                 |
| --------------- | ------------------------------- | -------------------------------------------------------------- | ------------------------------------- |
| **모터 입력 방식**    | DNN 원본 좌표(box_cx, box_cy) 직접 입력 | **OneEuro(min_cutoff=0.4)** 필터 적용 후 전달                         | DNN 잡음(±5px) → ±1px로 감소 (**80% 안정화**) |
| **제어 알고리즘**     | 거리별 3단계 Step 제어 (5,3,1)         | **비례제어(Kp_xy=0.02)** + Soft Deadzone + EMA 필터 + Adaptive Alpha | 속도 연속화, 급격한 진동 제거                     |
| **Deadzone 처리** | Hard 방식(내부 완전 정지)               | **Soft 감쇠형**(ratio × 0.5)                                      | 경계 진동 완전 제거                           |
| **Delay(갱신률)**  | 80/60/40ms (12.5~25Hz)          | **10/12/15ms (66~100Hz)**                                      | 약 **2.6~8배 빠른 반응**                    |
| **출력 평활화**      | 없음                              | **EMA 필터 + Adaptive Alpha**                                    | 급격한 출력 변화 억제                          |
| **거리 적응**       | 고정 반응                           | 거리 기반 Alpha 조정 (0.2~0.6)                                       | 멀리선 빠르게, 가까이선 부드럽게                    |
| **출력 제한**       | 각도 제한만 존재                       | **틱 제한 추가** (XY ±5, Z ±2)                                      | 과도한 모터 이동 방지                          |
| **DEADZONE 값**  | 70px (Hard)                     | 40px (Soft 적용)                                                 | 반응성 향상 + 경계 떨림 감소                     |
| **디버깅 로그**      | 단순 출력                           | **Adaptive 제어값, α, delay, raw/출력 표시**                          | 실험 중 제어 튜닝 용이                         |

---

### 2️⃣ 핵심 코드 변경 요약

* **Lines 1118–1119, 1143:**

  ```python
  filtered_motor_cx = int(motor_cx_oe.filter(box_cx, now))
  filtered_motor_cy = int(motor_cy_oe.filter(box_cy, now))
  angles = compute_motor_angles_safe(filtered_motor_cx, filtered_motor_cy, area, frame.shape)
  ```

* **Lines 240–317:**
  새로 작성된 `compute_motor_angles_safe()` 함수 (Step → 비례제어 전환)
  Soft Deadzone, EMA, Adaptive Alpha, 거리 기반 delay 조정 추가.

---

### 3️⃣ 변경 전·후 개념 비교

| 단계    | 이전 방식 (Step 제어)     | 현재 방식 (Adaptive 비례제어)              |
| ----- | ------------------- | ---------------------------------- |
| 입력    | DNN 좌표(노이즈 포함)      | OneEuro 필터 적용 좌표                   |
| 제어 로직 | 3단계 step 선택 (5/3/1) | Kp 계산 + Soft Deadzone + Clip + EMA |
| 응답 특성 | 계단형, 급격한 변동         | 연속형, 점진적 감쇠                        |
| 출력 신호 | 12~25Hz PWM 갱신      | 66~100Hz Adaptive PWM              |
| 제어 품질 | 경계 떨림, 오버슈트         | 안정적 추적, 멀미감 감소                     |

---

### 4️⃣ 변경 효과 요약

* 얼굴 추적 시 **진동률 감소**
* 모터 이동 시 **속도-위치 응답곡선 선형화**
* 추적 시 **시각적 흔들림 체감도 대폭 개선**
* 기존 **디지털 서보 과민 반응 문제 해결**
* 실제 사용자 관찰 시 **멀미 현상 완화**

---

## 🎯 핵심 결론

> 이번 업데이트는 **로봇팔 제어 시스템 전면 리디자인** 수준의 구조 개선으로,
> **DNN 좌표 노이즈 → 모터 제어까지 전 구간 필터링 및 비례 제어화**가 완료됨.
> 제어 안정성과 반응성이 동시에 개선되었으며, 다음 단계에서는
> **속도별 제어 프로파일 자동 조정 및 모터별 gain 튜닝**을 진행할 예정.

---

## 다음 회의

* **목표:** 개선된 비례제어 기반 코드로 평가지표 2, 3 재측정
* **예정일:** Discord 내 회의 일정 조율 예정
